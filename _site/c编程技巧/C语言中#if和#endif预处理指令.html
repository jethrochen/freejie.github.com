
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <!----
   <title>C语言中#if和#endif预处理指令 &larr; </title>
   ----->
   <title>C语言中#if和#endif预处理指令</title>
   <meta name="author" content="Chen Jie" />

   <link rel="start" href="/" />

	
	
	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />

</head>
<body id="">
<div id="site">
  
  <div id="header">
    <h1>
    	<a href="/" title="Chen Jie">Chen Jie</a>
        <!----
    	<span class="byline">&larr; <a href="/">Chen Jie</a></span>
        ----->
    </h1>
    <ul class="nav">
      <li><a class="home" href="/">Home</a></li>
      <li><a  href="/archive.html">Archive</a></li>
      <li><a  href="/pages.html">Pages</a></li>
      <li><a  href="/categories.html">Categories</a></li>
      <li><a  href="/tags.html">Tags</a></li>
    </ul>
  </div>

  
<div id="page">
	
  <h1 class="emphnext">C语言中#if和#endif预处理指令</h1>
  <ul class="tag_box inline">
  
  


  
     
    	<li><a href="/tags.html#C语言-ref">C语言 <span>1</span></a></li>
     
    	<li><a href="/tags.html#编程经验-ref">编程经验 <span>1</span></a></li>
     
    	<li><a href="/tags.html#编程技巧-ref">编程技巧 <span>1</span></a></li>
     
    	<li><a href="/tags.html#预编译-ref">预编译 <span>1</span></a></li>
     
    	<li><a href="/tags.html#条件编译-ref">条件编译 <span>1</span></a></li>
    
  



  </ul>

  <p>C语言中可以使用条件语句对预处理本身进行控制。这种方式为在编译过程中根据计算所得的条件值选择性地包含不同代码提供了一种手段。最常用的有一下几种：    </p>

<h4>1.#if !defined() 与#ifndef</h4>

<p>这个一般用于保证头文件只被包含一次。
<pre></p>

<h1>if !defined(HDR)</h1>

<h1>define HDR</h1>

<p>/* hdr.h文件的内容放在这里 */</p>

<h1>endif</h1>

<p></pre></p>

<p>第一次包含hdr.h时，将定义名字HDR，此后再次包含该头文件时，会发现该名字已经定义，就直接跳到#endif处。
C语言专门定义了两个预处理语句#ifdef与#ifndef，用来测试某个名字是否定义。上边的例子等价与
    #ifndef HDR
    #define HDR
    /* hdr.h文件的内容放在这里 */
    #endif</p>

<p>2.#if 判断式
根据预定义的LEVEL值，判断条件满足的语句才会被编译。</p>

<h1>define LEVEL 1</h1>

<h1>ifdef LEVEL</h1>

<h1>if (LEVEL &gt; 0) &amp;&amp; (LEVEL &lt; 2)</h1>

<p>printf(&quot;Debugging level 1&quot;);</p>

<h1>elif (LEVEL &gt; 1) &amp;&amp; (LEVEL &lt; 3)</h1>

<p>printf(&quot;Debugging level 2&quot;);</p>

<h1>elif (LEVEL &gt; n-1) &amp;&amp; (LEVEL &lt; n)</h1>

<p>printf(&quot;Debugging level n&quot;);</p>

<h1>endif</h1>

<h1>endif</h1>

<p>3.#if DEBUG
这一个经常被用来调试，在代码中添加一些打印信息是最常用的一种调试手段，但最终删除用来调试的打印信息却比较麻烦，这中方法可以帮我们很好地解决。看段代码test.c：</p>

<h1>include <stdio.h></h1>

<p>int count(num){
    int count = 0;</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">while(num){
    count++;
    num = num &amp; (num-1);
</code></pre></div>
<h1>if DEBUG</h1>
<div class="highlight"><pre><code class="text language-text" data-lang="text">    printf(&quot;%d %d\n&quot;, count, num);
</code></pre></div>
<h1>endif</h1>
<div class="highlight"><pre><code class="text language-text" data-lang="text">}

return count;
</code></pre></div>
<p>}</p>

<p>int main(void)
{
    int num = 10;
    printf(&quot;%d\n&quot;, count(num));</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">return 0;
</code></pre></div>
<p>}
用gcc test.c -o test -DDEBUG=1编译，会把#if DEBUG之间的代码编译进去，./test执行后显示
1 8
2 0
2
调试没问题之后，直接gcc test.c -o test就ok了，这样不会把用于调试的那句printf编译进去，当然也不会打印出来。
另外还有一种方法，调试的时候，在test.c开头加上</p>

<h1>define DEBUG 1</h1>

<p>调试结束注释掉这句就OK了。这中方法在编译的时候就不需要使用-DDEBUG这个参数了</p>

<p>4.#if 0
先上代码：</p>

<h1>if 0</h1>
<div class="highlight"><pre><code class="text language-text" data-lang="text">code
</code></pre></div>
<h1>endif</h1>

<p>在编译时，code部分会被忽略。于是我们就可以用这种方式进行代码注释，这样有两个好处，一是可以用作注释以解决C标准中/<strong>......</strong>/不能嵌套的缺陷；二是code部分很长的时候要比/<em>......</em>/更方便。在修改代码的时候，很多时候我们写的代码可能不许要了，但又不忍心删掉，这样注释是最好的办法。<br>
当然，把if后的0改为1，code部分就恢复作用。</p>


  <address class="signature">
    <a class="author" href="/">Chen Jie</a> 
    <span class="date">16 July 2013</span>
    <span class="location"></span>
  </address>
  
  <div class="prev-next">
  
  
    <a href="/%E5%AE%89%E8%A3%85windows7%E5%92%8Cubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E6%89%80%E9%81%87%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95.html" class="prev" title="安装windows7和ubuntu双系统所遇问题及解决方法">&larr; Earlier Post</a>
  
  </div>
  
</div><!-- End Page -->




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'freejie'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="http://freecoder.info">Chen Jie</a>. Design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  
</body>
</html>

